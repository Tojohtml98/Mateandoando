// ==========================================================================
// Utilidades
// ==========================================================================

// Espaciado
// ==========================================================================

// Margen y padding
@each $breakpoint in map-keys($grid-breakpoints) {
  @include media-breakpoint-up($breakpoint) {
    $infix: breakpoint-infix($breakpoint, $grid-breakpoints);

    @each $prop, $abbrev in (margin: m, padding: p) {
      @each $size, $length in $spacers {
        .#{$abbrev}#{$infix}-#{$size} { #{$prop}: $length !important; }
        .#{$abbrev}t#{$infix}-#{$size},
        .#{$abbrev}y#{$infix}-#{$size} {
          #{$prop}-top: $length !important;
        }
        .#{$abbrev}r#{$infix}-#{$size},
        .#{$abbrev}x#{$infix}-#{$size} {
          #{$prop}-right: $length !important;
        }
        .#{$abbrev}b#{$infix}-#{$size},
        .#{$abbrev}y#{$infix}-#{$size} {
          #{$prop}-bottom: $length !important;
        }
        .#{$abbrev}l#{$infix}-#{$size},
        .#{$abbrev}x#{$infix}-#{$size} {
          #{$prop}-left: $length !important;
        }
      }
    }

    // Margen negativo (solo para márgenes)
    @each $size, $length in $spacers {
      @if $size != 0 {
        .m#{$infix}-n#{$size} { margin: -$length !important; }
        .mt#{$infix}-n#{$size},
        .my#{$infix}-n#{$size} {
          margin-top: -$length !important;
        }
        .mr#{$infix}-n#{$size},
        .mx#{$infix}-n#{$size} {
          margin-right: -$length !important;
        }
        .mb#{$infix}-n#{$size},
        .my#{$infix}-n#{$size} {
          margin-bottom: -$length !important;
        }
        .ml#{$infix}-n#{$size},
        .mx#{$infix}-n#{$size} {
          margin-left: -$length !important;
        }
      }
    }
  }
}

// Tamaños de fuente responsivos
@each $breakpoint in map-keys($grid-breakpoints) {
  @include media-breakpoint-up($breakpoint) {
    $infix: breakpoint-infix($breakpoint, $grid-breakpoints);

    @each $size, $length in $font-sizes {
      .fs#{$infix}-#{$size} { font-size: $length !important; }
    }
  }
}

// Anchos y altos
@each $prop, $abbrev in (width: w, height: h) {
  @each $size, $length in $sizes {
    .#{$abbrev}-#{$size} { #{$prop}: $length !important; }
  }
}

// Colores
// ==========================================================================

// Colores de texto
@each $color, $value in $theme-colors {
  .text-#{$color} {
    color: $value !important;
  }
  
  .text-hover-#{$color} {
    transition: color 0.2s ease;
    
    &:hover, &:focus {
      color: $value !important;
    }
  }
}

// Fondos
@each $color, $value in $theme-colors {
  .bg-#{$color} {
    background-color: $value !important;
    
    @if $color == "light" {
      color: $dark;
    } @else if $color == "warning" {
      color: $dark;
    } @else {
      color: color-contrast($value);
    }
  }
  
  .bg-soft-#{$color} {
    background-color: rgba($value, 0.1) !important;
    color: $value !important;
  }
}

// Gradientes
.bg-gradient-primary {
  @include gradient-x($primary, $secondary, 0%, 100%);
  color: color-contrast($primary);
}

// Bordes
// ==========================================================================

// Bordes coloreados
@each $color, $value in $theme-colors {
  .border-#{$color} {
    border-color: $value !important;
  }
  
  .border-top-#{$color} {
    border-top-color: $value !important;
  }
  
  .border-end-#{$color} {
    border-right-color: $value !important;
  }
  
  .border-bottom-#{$color} {
    border-bottom-color: $value !important;
  }
  
  .border-start-#{$color} {
    border-left-color: $value !important;
  }
}

// Bordes redondeados
.rounded {
  &-top-0 {
    border-top-left-radius: 0 !important;
    border-top-right-radius: 0 !important;
  }
  
  &-right-0 {
    border-top-right-radius: 0 !important;
    border-bottom-right-radius: 0 !important;
  }
  
  &-bottom-0 {
    border-bottom-right-radius: 0 !important;
    border-bottom-left-radius: 0 !important;
  }
  
  &-left-0 {
    border-top-left-radius: 0 !important;
    border-bottom-left-radius: 0 !important;
  }
  
  &-circle {
    border-radius: 50% !important;
  }
  
  &-pill {
    border-radius: 50rem !important;
  }
}

// Sombras
.shadow {
  &-sm { box-shadow: $box-shadow-sm !important; }
  & { box-shadow: $box-shadow !important; }
  &-lg { box-shadow: $box-shadow-lg !important; }
  &-none { box-shadow: none !important; }
}

// Efectos de hover
.hover {
  &-shadow {
    transition: $transition-base;
    
    &:hover {
      box-shadow: $box-shadow !important;
    }
    
    &-lg:hover {
      box-shadow: $box-shadow-lg !important;
    }
  }
  
  &-scale {
    transition: transform 0.3s ease;
    
    &:hover {
      transform: scale(1.02);
    }
    
    &-lg:hover {
      transform: scale(1.05);
    }
  }
  
  &-translate-up:hover {
    transform: translateY(-5px);
  }
  
  &-translate-down:hover {
    transform: translateY(5px);
  }
}

// Utilidades de texto
// ==========================================================================

// Peso de la fuente
.font-weight-300 { font-weight: 300 !important; }
.font-weight-400 { font-weight: 400 !important; }
.font-weight-500 { font-weight: 500 !important; }
.font-weight-600 { font-weight: 600 !important; }
.font-weight-700 { font-weight: 700 !important; }
.font-weight-800 { font-weight: 800 !important; }
.font-weight-900 { font-weight: 900 !important; }

// Transformación de texto
.text-underline { text-decoration: underline !important; }
.text-uppercase { text-transform: uppercase !important; }
.text-lowercase { text-transform: lowercase !important; }
.text-capitalize { text-transform: capitalize !important; }

// Alineación de texto
.text-justify { text-align: justify !important; }

// Tamaño de texto responsivo
.text-sm-left { text-align: left !important; }
.text-sm-right { text-align: right !important; }
.text-sm-center { text-align: center !important; }

@include media-breakpoint-up(md) {
  .text-md-left { text-align: left !important; }
  .text-md-right { text-align: right !important; }
  .text-md-center { text-align: center !important; }
}

@include media-breakpoint-up(lg) {
  .text-lg-left { text-align: left !important; }
  .text-lg-right { text-align: right !important; }
  .text-lg-center { text-align: center !important; }
}

@include media-breakpoint-up(xl) {
  .text-xl-left { text-align: left !important; }
  .text-xl-right { text-align: right !important; }
  .text-xl-center { text-align: center !important; }
}

// Tamaños de texto
.text-xs { font-size: 0.75rem !important; }    // 12px
.text-sm { font-size: 0.875rem !important; }   // 14px
.text-base { font-size: 1rem !important; }     // 16px
.text-lg { font-size: 1.125rem !important; }   // 18px
.text-xl { font-size: 1.25rem !important; }    // 20px
.text-2xl { font-size: 1.5rem !important; }    // 24px
.text-3xl { font-size: 1.875rem !important; }  // 30px
.text-4xl { font-size: 2.25rem !important; }   // 36px
.text-5xl { font-size: 3rem !important; }      // 48px
.text-6xl { font-size: 4rem !important; }      // 64px

// Altura de línea
.lh-1 { line-height: 1 !important; }
.lh-sm { line-height: 1.25 !important; }
.lh-base { line-height: 1.5 !important; }
.lh-lg { line-height: 2 !important; }

// Espaciado de letras
.letter-spacing-1 { letter-spacing: 0.1em !important; }
.letter-spacing-2 { letter-spacing: 0.2em !important; }
.letter-spacing-3 { letter-spacing: 0.3em !important; }

// Utilidades de visualización
// ==========================================================================

// Overflow
.overflow-visible { overflow: visible !important; }
.overflow-hidden { overflow: hidden !important; }
.overflow-auto { overflow: auto !important; }
.overflow-x-auto { overflow-x: auto !important; }
.overflow-y-auto { overflow-y: auto !important; }

// Posición
.position-static { position: static !important; }
.position-relative { position: relative !important; }
.position-absolute { position: absolute !important; }
.position-fixed { position: fixed !important; }
.position-sticky { position: sticky !important; }

// Z-index
@for $i from 0 through 5 {
  .z-index-#{$i} { z-index: $i !important; }
}

// Visibilidad
.visible { visibility: visible !important; }
.invisible { visibility: hidden !important; }

// Utilidades de interacción
// ==========================================================================

// Selección de texto
.user-select-all { user-select: all !important; }
.user-select-auto { user-select: auto !important; }
.user-select-none { user-select: none !important; }

// Puntero
.pointer-events-none { pointer-events: none !important; }
.pointer-events-auto { pointer-events: auto !important; }

// Cursor
.cursor-pointer { cursor: pointer !important; }
.cursor-default { cursor: default !important; }
.cursor-move { cursor: move !important; }
.cursor-not-allowed { cursor: not-allowed !important; }
.cursor-zoom-in { cursor: zoom-in !important; }
.cursor-zoom-out { cursor: zoom-out !important; }

// Utilidades de flexbox
// ==========================================================================

// Dirección
.flex-row { flex-direction: row !important; }
.flex-column { flex-direction: column !important; }
.flex-row-reverse { flex-direction: row-reverse !important; }
.flex-column-reverse { flex-direction: column-reverse !important; }

// Envoltura
.flex-nowrap { flex-wrap: nowrap !important; }
.flex-wrap { flex-wrap: wrap !important; }
.flex-wrap-reverse { flex-wrap: wrap-reverse !important; }

// Justificación
.justify-content-start { justify-content: flex-start !important; }
.justify-content-end { justify-content: flex-end !important; }
.justify-content-center { justify-content: center !important; }
.justify-content-between { justify-content: space-between !important; }
.justify-content-around { justify-content: space-around !important; }
.justify-content-evenly { justify-content: space-evenly !important; }

// Alineación
.align-items-start { align-items: flex-start !important; }
.align-items-end { align-items: flex-end !important; }
.align-items-center { align-items: center !important; }
.align-items-baseline { align-items: baseline !important; }
.align-items-stretch { align-items: stretch !important; }

// Alineación de contenido
.align-content-start { align-content: flex-start !important; }
.align-content-end { align-content: flex-end !important; }
.align-content-center { align-content: center !important; }
.align-content-between { align-content: space-between !important; }
.align-content-around { align-content: space-around !important; }
.align-content-stretch { align-content: stretch !important; }

// Alineación automática
.align-self-auto { align-self: auto !important; }
.align-self-start { align-self: flex-start !important; }
.align-self-end { align-self: flex-end !important; }
.align-self-center { align-self: center !important; }
.align-self-baseline { align-self: baseline !important; }
.align-self-stretch { align-self: stretch !important; }

// Flex
.flex-fill { flex: 1 1 auto !important; }
.flex-grow-0 { flex-grow: 0 !important; }
.flex-grow-1 { flex-grow: 1 !important; }
.flex-shrink-0 { flex-shrink: 0 !important; }
.flex-shrink-1 { flex-shrink: 1 !important; }

// Orden
@for $i from 0 through 12 {
  .order-#{$i} { order: $i !important; }
}

// Utilidades de grid
// ==========================================================================

// Columnas
@for $i from 1 through 12 {
  .col-#{$i} {
    flex: 0 0 percentage($i / $grid-columns);
    max-width: percentage($i / $grid-columns);
  }
  
  .offset-#{$i} {
    margin-left: percentage($i / $grid-columns);
  }
}

// Utilidades de transición
// ==========================================================================

.transition {
  &-none { transition: none !important; }
  
  &-all { transition: all 0.3s ease !important; }
  
  &-opacity { transition: opacity 0.3s ease !important; }
  
  &-transform { transition: transform 0.3s ease !important; }
  
  &-colors {
    transition: color 0.15s ease-in-out, 
                background-color 0.15s ease-in-out, 
                border-color 0.15s ease-in-out, 
                box-shadow 0.15s ease-in-out !important;
  }
}

// Utilidades de animación
// ==========================================================================

.animation {
  &-none { animation: none !important; }
  
  &-spin {
    animation: spin 2s linear infinite;
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  }
  
  &-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
  }
  
  &-bounce {
    animation: bounce 1s infinite;
    
    @keyframes bounce {
      0%, 100% { transform: translateY(-25%); animation-timing-function: cubic-bezier(0.8, 0, 1, 1); }
      50% { transform: translateY(0); animation-timing-function: cubic-bezier(0, 0, 0.2, 1); }
    }
  }
}

// Utilidades de accesibilidad
// ==========================================================================

.sr-only,
.sr-only-focusable:not(:focus):not(:focus-within) {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

// Utilidades de impresión
// ==========================================================================

@media print {
  .d-print-none { display: none !important; }
  .d-print-inline { display: inline !important; }
  .d-print-inline-block { display: inline-block !important; }
  .d-print-block { display: block !important; }
  .d-print-table { display: table !important; }
  .d-print-table-row { display: table-row !important; }
  .d-print-table-cell { display: table-cell !important; }
  .d-print-flex { display: flex !important; }
  .d-print-inline-flex { display: inline-flex !important; }
  
  // Ocultar elementos en la impresión
  .no-print { display: none !important; }
  
  // Mostrar solo el contenido principal en la impresión
  .print-content-only {
    & > *:not(main) { display: none; }
    
    main {
      display: block !important;
      width: 100% !important;
      max-width: 100% !important;
      padding: 0 !important;
      margin: 0 !important;
      border: 0 !important;
      
      // Asegurar que las imágenes no se corten
      img { max-width: 100% !important; }
      
      // Evitar saltos de página dentro de elementos
      h1, h2, h3, h4, h5, h6, p, ul, ol, dl, blockquote, pre, table, figure {
        page-break-inside: avoid;
      }
      
      // Asegurar que los encabezados no queden solos al final de la página
      h1, h2, h3, h4, h5, h6 {
        page-break-after: avoid;
      }
    }
  }
}
